MACKE - Modular and Compositional Analysis with KLEE Engine
===

Author's note
---

A short introduction and usage guide for MACKE is available as a [demo on YouTube](https://www.youtube.com/watch?v=icC3jc3mHEU). 

[Email me](mailto:ognawala@in.tum.de) if something is broken. Ditto if you would like to contribute! 

-- [Saahil Ognawala](https://www.i22.in.tum.de/index.php?id=31&L=1)

Pre-requisites for installation
---
Following are the *minimum* requirements before installing MACKE. 

- **Python 3.4+**
-  **KLEE** - We have prepared a [KLEE installation guide](https://github.com/hutoTUM/install-klee) that includes all the pre-requisites for KLEE, such as LLVM's Clang toolkit, uclibc and a SMT solver. 
- **Libclang** - MACKE requires Python wrappings for libclang's C/C++ parsing library to work correctly. A nice guide to parsing C++ in Python can be found at [Eli Bendersky's website](http://eli.thegreenplace.net/2011/07/03/parsing-c-in-python-with-clang), that includes some installation details. 

Please note that we installed MACKE and performed all our experiments on Ubuntu 14.04. Some dependencies may differ based on your system

Description of included scripts
---
+ `analyze_klee_test.py` - Analyze KLEE .ptr.err files to analyze infected functions, their files and line numbers.
+ `batch_generate_unit.py` - Defunct. Has no purpose at the moment, except for Ngircd experiments. IGNORE! 
+ `batch_klee.py` - Runs KLEE on the seperate unit tests (generated by `batch_generate_units.py`) and stores results in respective output folders for isolated functions. Ideally, should be run right after generating separate unit test files. 
+ `batch_separate_units.py` - Runs `generate_seperate_unit.py` script in batch mode for all C files in the source directory. Ideally, the starting point of the full MACKE framework. 
+ `branch_analyzer.py` - Analyzes static elements (condition, true-block, false-block) of an if-else block. 
+ `c_keywords.py` - For playing around with libclang. Lists out keywords and lexical structures for C language sources. IGNORE!
+ `callee.py` - Analyzes caller-callee relationship between all functions (defined within the project source) and lists them. 
+ `cindex-dump.py` - Dump whole abstract syntax tree of the project under test. Can be ignored, serves no practical purpose in MACKE. 
+ `compose_units.py` - Performs the first step of compositional analysis. Compares test output files (.ptr.err and others) to get chain of affected functions. Gets a list of outlier functions and writes everything to composition.test. Usually doesn't need to be run separately. Essential functions called by `batch_klee.py`. 
+ `copy_main_unit.py` - Copy main function into it's own "unit test". Usually doesn't need to be run separately. 
+ `create_call_graph.py` - Generate [pydot]([https://pypi.python.org/pypi/pydot]) nodes and edges for interactive program call graph in the HTML output. 
+ `generate_separate_unit.py` - Generates seperate unit test file for isolated functons. Outputs *.c.units in the parent source file's respective directory. 
+ `generate_unit.py` - Old (most likely, broken) version of `generate_separate_unit.py`. IGNORE!
+ `html_artifacts.py`- Creates static HTML pages for the interactive report, list of bugs and pointer error details. 
+ `instrument_branches.py`- For future work  - recording branch coverage in source - for hybrid blackbox+whitebox fuzzing. Ignore for now! 
+ `log_branch.py`- Future work - log traversed branches in source. Ignore for now!
+ `read_istats.py`- Parse run.istats files for all individual KLEE runs. 
+ `read_ktest.py`- Parse ktest output (output from `ktest-tool`) from individual KLEE runs. 
+ `remove_global.py` - Treats some particularities in files where functions are declared GLOBAL. 
+ `second_klee_round.py` - For the second step of compositional analysis. Runs KLEE with the modified code (with `klee_assert` statements) for partial PC matching. 
+ `source_coverage.py` - Calculate approximate source code coverage, from the information parsed from run.istats. 
+ `source_coverage_main.py` - IGNORE!
